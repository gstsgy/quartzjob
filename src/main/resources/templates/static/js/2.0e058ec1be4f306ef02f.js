webpackJsonp([2],{F1BO:function(t,e,o){"use strict";var a=o("dueY");o.n(a)},HXef:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"Home",data:function(){var t=this;return{total:0,isSelected:!1,formFilter:{pageSize:20,pageNum:1},columns:[{type:"selection",key:"select",width:60,align:"center"},{title:"序号",key:"index",minWidth:80,align:"center",render:function(e,o){return e("div",t.formFilter.pageSize*(t.formFilter.pageNum-1)+1+o.index)}},{title:"任务id",key:"id",align:"center",minWidth:100},{title:"任务名称",key:"jobName",align:"center",minWidth:100},{title:"任务描述",key:"jobDesc",align:"center",minWidth:100},{title:"cron表达式",key:"cronExpression",align:"center",minWidth:180},{title:"执行接口",key:"targeturl",align:"center",minWidth:200},{title:"任务状态",key:"jobStatus",align:"center",minWidth:100,slot:"jobStatus"},{title:"创建时间",key:"createTime",align:"center",minWidth:180},{title:"更新时间",key:"updateTime",align:"center",minWidth:180},{title:"执行",align:"center",minWidth:150,render:function(e,o){return e("Button",{props:{type:"primary",disabled:0==o.row.jobStatus},on:{click:function(e){t._axios("put","run",o.row)}}},"运行一次")}}],tableData:[],tableHeight:400,modalTitle:"新增定时任务",modal:!1,modalForm:{},modalValidate:{jobName:[{required:!0,message:"任务名称不可为空",trigger:"change"}],cronExpression:[{required:!0,message:"cron表达式不可为空",trigger:"change"}],targeturl:[{required:!0,message:"执行接口不可为空",trigger:"change"}]}}},created:function(){},mounted:function(){this.tableHeight=window.innerHeight-this.$refs.table.$el.offsetTop-140,this.getData(),this.getData=this.debounce(this.getData)},computed:{},methods:{getData:function(t){var e=this;t&&(this.formFilter.pageNum=t),this._axios("get","jobs",this.formFilter,function(t){e.tableData=t,e.total=t.length,t.length<1&&e.$Message.warning("暂无符合条件的数据")})},changeJobStatus:function(t){console.log(t),this._axios("put","jobstatus",t,function(t){}),this.getData()},submit:function(){},showUpdate:function(t){0==t.jobStatus?(this.modalForm=t,this.modalTitle="更新定时任务",this.submit=this.update,this.modal=!0):this.$Message.error("任务状态为开启时，不可修改")},update:function(){var t=this;this.$refs.modalForm.validate(function(e){e&&t._axios("put","job",t.modalForm,function(e){e?(t.$Message.success("更新成功"),t.modal=!1,t.getData()):t.$Message.error("更新失败")})})},showInsert:function(){this.modalForm={jobStatus:1},this.modalTitle="新增定时任务",this.submit=this.insert,this.modal=!0},insert:function(){var t=this;this.$refs.modalForm.validate(function(e){e&&t._axios("post","job",t.modalForm,function(e){e?(t.$Message.success("新增成功"),t.modal=!1,t.getData()):t.$Message.error("新增失败")})})},deleteConfirm:function(){var t=this;this.isSelected?this.$root.mes1("warn","是否确定删除？").then(function(e){e&&t._axios("delete","jobs",t.$refs.table.getSelection(),function(e){e?(t.$Message.success("删除成功"),t.getData(),t.isSelected=!1):t.$Message.error("删除失败")})}):this.$Message.error("请选择数据")},portOut:function(){this.$axios.get("down").then(function(t){var e=new Blob([t]),o=document.createElement("a");o.style.display="none";var a=window.URL.createObjectURL(e);o.href=a,o.setAttribute("download","导出.txt"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(a)})},portIn:function(t){var e=this,o=new FormData;return o.append("file",t),this._axios("put","upload",o,function(t){e.$Message.success("导入成功")}),!1}}},r=(o("F1BO"),o("K1/g")),i=Object(r.a)(a,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"home"},[o("Form",{attrs:{"label-width":100},model:{value:t.formFilter,callback:function(e){t.formFilter=e},expression:"formFilter"}},[o("Row",[o("Col",{attrs:{span:"4"}},[o("FormItem",{attrs:{label:"任务名称"}},[o("Input",{attrs:{clearable:""},on:{"on-change":function(e){return t.getData(1)}},model:{value:t.formFilter.name,callback:function(e){t.$set(t.formFilter,"name",e)},expression:"formFilter.name"}})],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"spaceBetween bottomSpace"},[o("div",[o("Button",{staticClass:"btnForm",attrs:{shape:"circle",type:t.isSelected?"error":"default"},on:{click:t.deleteConfirm}},[t._v("删除选中项")])],1),t._v(" "),o("div",[o("Button",{staticClass:"btnForm",attrs:{shape:"circle",type:"primary"},on:{click:t.portOut}},[t._v("导出")]),t._v(" "),o("div",{staticStyle:{display:"inline-block"}},[o("Upload",{attrs:{action:"","before-upload":t.portIn}},[o("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("导入")])],1)],1),t._v(" "),o("Button",{staticClass:"btnForm",attrs:{shape:"circle",type:"primary"},on:{click:t.showInsert}},[t._v("新增")])],1)]),t._v(" "),o("Table",{ref:"table",attrs:{height:t.tableHeight,border:"",stripe:"",columns:t.columns,data:t.tableData},on:{"on-row-dblclick":t.showUpdate,"on-selection-change":function(e){return t.isSelected=e.length>0}},scopedSlots:t._u([{key:"jobStatus",fn:function(e){var a=e.row;return e.index,[o("i-switch",{attrs:{"true-value":1,"false-value":0},on:{"on-change":function(e){return t.changeJobStatus(a)}},model:{value:a.jobStatus,callback:function(e){t.$set(a,"jobStatus",e)},expression:"row.jobStatus"}})]}}])}),t._v(" "),o("Modal",{attrs:{width:"1000",title:t.modalTitle},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[o("Form",{ref:"modalForm",attrs:{model:t.modalForm,"label-width":100,rules:t.modalValidate}},[o("Row",[o("Col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"任务名称",prop:"jobName"}},[o("Input",{attrs:{clearable:""},model:{value:t.modalForm.jobName,callback:function(e){t.$set(t.modalForm,"jobName",e)},expression:"modalForm.jobName"}})],1)],1),t._v(" "),o("Col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"任务描述",prop:"jobDesc"}},[o("Input",{attrs:{clearable:""},model:{value:t.modalForm.jobDesc,callback:function(e){t.$set(t.modalForm,"jobDesc",e)},expression:"modalForm.jobDesc"}})],1)],1),t._v(" "),o("Col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"cron表达式",prop:"cronExpression"}},[o("Input",{attrs:{clearable:""},model:{value:t.modalForm.cronExpression,callback:function(e){t.$set(t.modalForm,"cronExpression",e)},expression:"modalForm.cronExpression"}})],1)],1),t._v(" "),o("Col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"执行接口",prop:"targeturl"}},[o("Input",{attrs:{clearable:""},model:{value:t.modalForm.targeturl,callback:function(e){t.$set(t.modalForm,"targeturl",e)},expression:"modalForm.targeturl"}})],1)],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.submit}},[t._v("提交")])],1)],1)],1)},[],!1,null,null,null);e.default=i.exports},dueY:function(t,e){}});
//# sourceMappingURL=2.0e058ec1be4f306ef02f.js.map